#########################
# UltraStarFox Makefile #
#########################

# Assembler
ASM=SASMX
ASMFLAGS=-efilelist=0 -x..\symbols.txt

# Linker
LINK=ARGLINK
LOPTS=-b30 -h1024 -t7d

# ROM Extender
EXTEND=EXTEND
EXTOPS= 16 ff

# Checksum Fixer
CHECK=SFCHECK
COPTS=-s -f

# FXGfx Interleaver
MERGE=MERGE
MOPTS= /cgx

# Graphics Cruncher
CRU=CRU

ALLFILES= BANK\bank0.sob BANK\bank1.sob BANK\bank2.sob \
 BANK\bank4.sob BANK\bank5.sob BANK\bank6.sob BANK\bank7.sob \
 BANK\bank8.sob BANK\bank9.sob BANK\bank10.sob \
 BANK\bank11.sob BANK\shbanks.sob BANK\incbins.sob

# Compressible GFX
CGXFILES= DATA\1-3-B.CCR DATA\2-3B.CCR DATA\3-4.CCR DATA\B.CCR DATA\CONT.CCR DATA\DOG.CCR \
 DATA\F-1.CCR DATA\FS-BG3.CCR DATA\MAP-G.CCR DATA\OBJ-2.CCR DATA\SPACE.CCR DATA\T-ST.CCR \
 DATA\TI.CCR DATA\1-4.CCR DATA\2-4.CCR DATA\AND.CCR DATA\C-M.CCR DATA\CP-G.CCR DATA\E-TEST.CCR \
 DATA\F-OBJ.CCR DATA\HOLE-A.CCR DATA\MAP.CCR DATA\OBJ-3.CCR DATA\ST-P.CCR DATA\TI-3-G.CCR DATA\2-2.CCR \
 DATA\3-2.CCR DATA\B-HOLE.CCR DATA\CONT-2-G.CCR DATA\CP.CCR DATA\E-TEST2.CCR DATA\FOX-G.CCR DATA\LSB.CCR \
 DATA\OBJ-1-G.CCR DATA\OBJ-4.CCR DATA\STARS.CCR DATA\TI-3-US.CCR DATA\2-3.CCR DATA\3-3.CCR DATA\B-M.CCR \
 DATA\CONT-2.CCR DATA\DEMO.CCR DATA\E.CCR DATA\FOX.CCR DATA\M.CCR DATA\OBJ-1.CCR DATA\SC.CCR DATA\T-SP.CCR \
 DATA\TI-3.CCR

SCRFILES= DATA\1-3-B.PCR DATA\2-3.PCR DATA\3-2.PCR DATA\B-HOLE.PCR DATA\CONT.PCR DATA\DOG.PCR \
 DATA\F-1.PCR DATA\LAST.PCR DATA\SC.PCR DATA\T-SP.PCR DATA\TI-3-US.PCR DATA\1-3.PCR \
 DATA\2-3B.PCR DATA\3-3.PCR DATA\B.PCR DATA\CP-G.PCR DATA\E-TEST.PCR DATA\FOX.PCR \
 DATA\LSB.PCR DATA\ST-P.PCR DATA\T-SS.PCR DATA\TI-3.PCR DATA\1-4.PCR DATA\2-3H.PCR \
 DATA\3-4.PCR DATA\CONT-2-G.PCR DATA\CP.PCR DATA\E-TEST2.PCR DATA\FS-NI.PCR DATA\M.PCR \
 DATA\STARS.PCR DATA\T-ST.PCR DATA\TI.PCR DATA\2-2.PCR DATA\2-4.PCR DATA\AND.PCR \
 DATA\CONT-2.PCR DATA\DEMO.PCR DATA\E.PCR DATA\HOLE-A.PCR DATA\MAP.PCR DATA\T-F-S.PCR \
 DATA\TI-3-G.PCR

COLFILES= DATA\COL\2EP.COL DATA\COL\B-M.COL DATA\COL\BG2-C.COL DATA\COL\BG2-F.COL \
 DATA\COL\CONTEST.COL DATA\COL\CP-USP.COL DATA\COL\E-TEST0.COL DATA\COL\LIGHT.COL \
 DATA\COL\NIGHT.COL DATA\COL\RED.COL DATA\COL\T-M-2.COL DATA\COL\T-M.COL DATA\COL\BG2-A.COL \
 DATA\COL\BG2-D.COL DATA\COL\BG2-G.COL DATA\COL\CP-G.COL DATA\COL\CP.COL DATA\COL\HOLE.COL \
 DATA\COL\MAP_C.COL DATA\COL\OBJ-1.COL DATA\COL\SPACE.COL DATA\COL\T-M-3.COL DATA\COL\BG2-B.COL \
 DATA\COL\BG2-E.COL DATA\COL\BLUE.COL DATA\COL\CP-US.COL DATA\COL\E-TEST.COL DATA\COL\L.COL \
 DATA\COL\MIST.COL DATA\COL\OVER_D.COL DATA\COL\STARS.COL DATA\COL\T-M-4.COL

.asm.sob:
	@$(ASM) -m30 $(ASMFLAGS) $< -v$*.SOB

.cgx.ccr:
	@$(CRU) $< $*.CCR

.scr.pcr:
	@$(CRU) $< $*.PCR

#all: msprites allcols crunch sf.rom
all: allcols msprites crunch sf.rom

# Pack Palettes
allcols: $(COLFILES)
	@cd DATA
	@cd COL
	@pc.bat
	@cd ..
	@cd ..

# Interleave FXGfx
msprites: tex_01.bin tex_23.bin tex_23_a.bin

tex_01.bin:
	@$(MERGE) MSPRITES\tex_0.CGX MSPRITES\tex_1.CGX MSPRITES\tex_01.bin $(MOPTS)

tex_23.bin:
	@$(MERGE) MSPRITES\tex_2.CGX MSPRITES\tex_3.CGX MSPRITES\tex_23.bin $(MOPTS)

tex_23_a.bin:
	@$(MERGE) MSPRITES\tex_2.CGX MSPRITES\tex_3_a.CGX MSPRITES\tex_23_a.bin $(MOPTS)

# Crunch all compressible GFX
crunch: $(CGXFILES) $(SCRFILES)

# The ROM Itself
sf.rom: $(ALLFILES)
	@$(LINK) $(LOPTS) -osf.rom @flist
	@$(EXTEND) sf.rom $(EXTOPS)
	@$(CHECK) $(COPTS) sf.rom
	@del msgs.txt

# clean everything up
clean:
	del BANK\*.SOB

# Included files
INCFILES= INC\ALCS.INC INC\ARCTAN.INC INC\BGMACS.INC INC\BGMACS2.INC INC\DALCS.INC INC\EALCS.INC INC\GILESAL.INC \
 INC\GILESALC.INC INC\GILESALX.INC INC\GRIDVARS.INC INC\HEADER.INC INC\ISTRATS.INC INC\KALCS.INC \
 INC\MACROS.INC INC\MAPMACS.INC INC\MAPSTRUC.INC INC\MARIOI.INC INC\MDATA.INC INC\MOUSEALC.INC \
 INC\MSUREGS.INC INC\MSUTRKS.INC INC\SFXREGS.INC INC\SHMACS.INC INC\SOUNDEQU.INC INC\STRATEQU.INC \
 INC\STRATHDR.INC INC\STRATLIB.INC INC\STRATMAC.INC INC\STRUCTS.INC INC\TAIL.INC INC\WEAPONS.INC

CONFIGFILES= VARS.INC CONFIG\CONFIG.INC CONFIG\DEBUG.INC CONFIG\GAME.INC CONFIG\GRAPHICS.INC \
 CONFIG\XCESSORY.INC

SHAPEFILES= SHAPES\KSHAPES.ASM SHAPES\PSHAPES.ASM SHAPES\SHAPES.ASM SHAPES\SHAPES2.ASM \
 SHAPES\SHAPES3.ASM SHAPES\SHAPES4.ASM SHAPES\SHAPES5.ASM SHAPES\SHAPES6.ASM SHAPES\SHAPES7.ASM \
 SHAPES\USHAPES.ASM

STRATFILES= STRAT\D2STRATS.ASM STRAT\D3STRATS.ASM STRAT\DSTRATS.ASM STRAT\EXPSTRAT.ASM \
 STRAT\GA2STRAT.ASM STRAT\GA3STRAT.ASM STRAT\GASTRATS.ASM STRAT\GB2STRAT.ASM STRAT\GB3STRAT.ASM \
 STRAT\GBSTRATS.ASM STRAT\GCSTRATS.ASM STRAT\GISTRATS.ASM STRAT\GSTRATS.ASM STRAT\ISTRATS.ASM \
 STRAT\KSTRATS.ASM STRAT\PCSTRATS.ASM STRAT\PISTRATS.ASM STRAT\PSTRATS.ASM STRAT\STRATROU.ASM

PATHFILES= PATH\DPATHDAT PATH\EPATHDAT PATH\KPATHDAT PATH\PATHDATA PATH\PATHMACS.ASM PATH\PATHS.ASM

MAPFILES= MAPS\1-1.ASM MAPS\C3-1.ASM MAPS\CL_WARP.ASM MAPS\ELEVE1_1.ASM MAPS\LEVEL2_2.ASM MAPS\LEVEL_BH.ASM \
 MAPS\MAP1_3C.ASM MAPS\MAP2_3B.ASM MAPS\MAP3_3B.ASM MAPS\MAPLIST3.ASM MAPS\WASHMAPE.ASM MAPS\1-3-T1.ASM \
 MAPS\CASTANET.ASM MAPS\CL_WARPO.ASM MAPS\EMAP1_2.ASM MAPS\LEVEL2_3.ASM MAPS\LEVEL_S.ASM MAPS\MAP1_3D.ASM \
 MAPS\MAP2_3C.ASM MAPS\MAP3_4A.ASM MAPS\MAPP.ASM MAPS\WEBMONST.ASM MAPS\1-3-T2.ASM MAPS\CLEVEL1_.ASM \
 MAPS\CMAP1_1B.ASM MAPS\EVENT.ASM MAPS\LEVEL2_4.ASM MAPS\LEXITMAP.ASM MAPS\MAP1_4.ASM MAPS\MAP2_4.ASM \
 MAPS\MAP3_4B.ASM MAPS\MEXITMAP.ASM MAPS\1-3-T3.ASM MAPS\CL_BRIDG.ASM MAPS\CMAP1_2.ASM MAPS\FINALMAP.ASM \
 MAPS\LEVEL2_5.ASM MAPS\MAP1_1A.ASM MAPS\MAP1_5.ASM MAPS\MAP2_5.ASM MAPS\MAP3_4C.ASM MAPS\MOTHERS.ASM \
 MAPS\2-1.ASM MAPS\CL_CHASE.ASM MAPS\CMAP2_1B.ASM MAPS\INTRO.ASM MAPS\LEVEL2_6.ASM MAPS\MAP1_1B.ASM \
 MAPS\MAP1_6A.ASM MAPS\MAP2_6A.ASM MAPS\MAP3_5.ASM MAPS\PLANET.ASM MAPS\3-1.ASM MAPS\CL_COLON.ASM \
 MAPS\CMAP2_2.ASM MAPS\LEVEL1_1.ASM MAPS\LEVEL3_1.ASM MAPS\MAP1_2.ASM MAPS\MAP1_6B.ASM MAPS\MAP2_6B.ASM \
 MAPS\MAP3_6.ASM MAPS\SPECIAL.ASM MAPS\3-4-T.ASM MAPS\CL_DIVE.ASM MAPS\CMAP3_1B.ASM MAPS\LEVEL1_2.ASM \
 MAPS\LEVEL3_2.ASM MAPS\MAP1_3A.ASM MAPS\MAP1_6C.ASM MAPS\MAP2_6C.ASM MAPS\MAP3_7A.ASM MAPS\TITLE.ASM \
 MAPS\AIRLOCK1.ASM MAPS\CL_EARTH.ASM MAPS\CMAP3_2.ASM MAPS\LEVEL1_3.ASM MAPS\LEVEL3_3.ASM MAPS\MAP1_3A1.ASM \
 MAPS\MAP1_6D.ASM MAPS\MAP2_6D.ASM MAPS\MAP3_7B.ASM MAPS\TRAINING.ASM MAPS\ARMSMAP.ASM MAPS\CL_GND.ASM \
 MAPS\CREDITS.ASM MAPS\LEVEL1_4.ASM MAPS\LEVEL3_4.ASM MAPS\MAP1_3A2.ASM MAPS\MAP2_1A.ASM MAPS\MAP3_1A.ASM \
 MAPS\MAP3_7C.ASM MAPS\TRANSFOR.ASM MAPS\BHOLE.ASM MAPS\CL_SHIP.ASM MAPS\DM_END.ASM MAPS\LEVEL1_5.ASM \
 MAPS\LEVEL3_5.ASM MAPS\MAP1_3B.ASM MAPS\MAP2_1B.ASM MAPS\MAP3_1B.ASM MAPS\MAP3_7D.ASM MAPS\TRUCKER.ASM \
 MAPS\C1-1.ASM MAPS\CL_TURN.ASM MAPS\DM_LB1.ASM MAPS\LEVEL1_6.ASM MAPS\LEVEL3_6.ASM MAPS\MAP1_3B1.ASM \
 MAPS\MAP2_2.ASM MAPS\MAP3_2.ASM MAPS\MAPLIST.ASM MAPS\WASHENT.ASM MAPS\C2-1.ASM MAPS\CL_UNDER.ASM \
 MAPS\E1-1.ASM MAPS\LEVEL2_1.ASM MAPS\LEVEL3_7.ASM MAPS\MAP1_3B2.ASM MAPS\MAP2_3A.ASM MAPS\MAP3_3A.ASM \
 MAPS\MAPLIST2.ASM MAPS\WASHMAP.ASM

SOUNDFILES= SND\GSGSNDA.BIN SND\PSGSNDA.BIN SND\SGBGM2.BIN SND\SGBGM6.BIN SND\SGBGMA.BIN SND\SGBGME.BIN \
 SND\SGBGMI.BIN SND\SGBGMM.BIN SND\SGSOUND0.BIN SND\SGSOUND4.BIN SND\SGSOUND8.BIN SND\PSGBGMM.BIN \
 SND\SGBGM1.BIN SND\SGBGM3.BIN SND\SGBGM7.BIN SND\SGBGMB.BIN SND\SGBGMF.BIN SND\SGBGMJ.BIN SND\SGBGMN.BIN \
 SND\SGSOUND1.BIN SND\SGSOUND5.BIN SND\SGSOUND9.BIN SND\PSGSND2.BIN SND\SGBGM10.BIN SND\SGBGM4.BIN SND\SGBGM8.BIN \
 SND\SGBGMC.BIN SND\SGBGMG.BIN SND\SGBGMK.BIN SND\SGBGMO.BIN SND\SGSOUND2.BIN SND\SGSOUND6.BIN SND\SGSOUNDA.BIN \
 SND\PSGSND5.BIN SND\SGBGM11.BIN SND\SGBGM5.BIN SND\SGBGM9.BIN SND\SGBGMD.BIN SND\SGBGMH.BIN SND\SGBGML.BIN \
 SND\SGBGMP.BIN SND\SGSOUND3.BIN SND\SGSOUND7.BIN

## Banks 0, 32
bank0.sob: \
$(INCFILES) $(CONFIGFILES) $(SHAPEFILES) $(STRATFILES) \
BANK\bank0.ASM \
ASM\SGTABS.ASM ASM\SGDATA.ASM ASM\MSU.ASM


## Banks 1, 41
bank1.sob: \
$(INCFILES) $(CONFIGFILES) \
BANK\BANK1.ASM \
ASM\FONTDATA.ASM

## Banks 2, 3, 31, 36
bank2.sob: \
$(INCFILES) $(CONFIGFILES) $(STRATFILES) $(MAPFILES) \
BANK\BANK2.ASM \
ASM\RAMSTUFF.ASM ASM\TRANS.ASM ASM\MAIN.ASM ASM\GAME.ASM ASM\WINDOWS.ASM ASM\COLTABS.ASM \
ASM\BGS.ASM ASM\OBJ.ASM ASM\PLANETS.ASM ASM\SPRITES.ASM ASM\CONTINUE.ASM ASM\WORLD.ASM \
ASM\DEBUG.ASM ASM\BOOTNMI.ASM ASM\BLINK.ASM ASM\NMI.ASM ASM\DRAW.ASM ASM\ENDSEQ.ASM \
ASM\CONT.ASM ASM\SOUND.ASM

## Bank 4
bank4.sob: \
$(INCFILES) $(CONFIGFILES) $(STRATFILES) $(PATHFILES) \
BANK\BANK4.ASM


## Banks 5, 13, 39
bank5.sob: \
$(INCFILES) $(CONFIGFILES) $(STRATFILES) $(MAPFILES) \
BANK\BANK5.ASM


## Banks 6, 33
bank6.sob: \
$(INCFILES) $(CONFIGFILES) $(STRATFILES) $(MAPFILES) \
BANK\BANK6.ASM \
ASM\BLINK.ASM

## Bank 7
bank7.sob: \
$(INCFILES) $(CONFIGFILES) $(STRATFILES) \
BANK\BANK7.ASM


## Bank 8
bank8.sob: \
$(INCFILES) $(CONFIGFILES) $(STRATFILES) $(SOUNDFILES) \
BANK\BANK8.ASM 


## Bank 9
bank9.sob: \
$(INCFILES) $(CONFIGFILES) $(STRATFILES) $(SOUNDFILES) \
BANK\BANK9.ASM


## Bank 10
bank10.sob: \
$(INCFILES) $(CONFIGFILES) $(STRATFILES) $(SOUNDFILES) \
BANK\BANK10.ASM \
ASM\MEM.ASM


## Banks 11, 40
bank11.sob: \
$(INCFILES) $(CONFIGFILES) $(STRATFILES) \
BANK\BANK11.ASM


## Banks 12, 14, 15, 16, 17, 37, 38
shbanks.sob: \
$(INCFILES) $(CONFIGFILES) $(SHAPEFILES) $(SOUNDFILES) \
BANK\SHBANKS.ASM


## Banks 18, 19, 20, 21, 22, 23, 35 
incbins.sob: \
$(INCFILES) $(CONFIGFILES) $(SOUNDFILES) \
BANK\INCBINS.ASM





